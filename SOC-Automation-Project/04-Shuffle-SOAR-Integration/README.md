# Part 3: Shuffle SOAR Integration

## Description  
Shuffle SOAR (Security Orchestration, Automation, and Response) is used to automate the response process for alerts generated by the Wazuh Manager.  
By integrating Shuffle with Wazuh, security teams can reduce manual effort, enrich alerts with threat intelligence, and forward them to case management platforms like TheHive for investigation.  

## Tasks  

### 1. Connect Wazuh Alerts to Shuffle  
- Configure Wazuh Manager to forward alerts to Shuffle via a webhook.  
- Set up a Shuffle trigger that captures incoming alerts in JSON format.  
- Ensure alert fields (source IP, user, process, hash, etc.) are mapped correctly for further automation.  

### 2. Enrich Alerts Using Threat Intelligence  
- Integrate Shuffle with VirusTotal, AbuseIPDB, AlienVault OTX, and other TI sources.  
- Automate lookups for:  
  - **IP addresses** → check for malicious reputation.  
  - **File hashes (MD5/SHA256)** → check if known malware.  
  - **Domains/URLs** → identify phishing or malicious hosting.  
- Add enrichment results back into the alert for context (ex: malicious IP flagged in VirusTotal).  

### 3. Forward Enriched Alerts to TheHive  
- Design a workflow in Shuffle that automatically forwards enriched alerts to TheHive.  
- Include key details such as:  
  - Original alert source (from Wazuh).  
  - Enrichment results from VirusTotal or other feeds.  
  - Severity score based on correlated intelligence.  
- Ensure that TheHive receives structured data to automatically create a new case for investigation.  

### 4. Benefits of Integration  
- **Faster Incident Response** → reduces manual enrichment tasks.  
- **Centralized Threat Intelligence** → all alerts carry context from multiple sources.  
- **Automated Case Creation** → investigators in TheHive receive fully enriched cases.  
- **Scalable SOC Workflow** → easy to extend with more integrations and playbooks.  
